import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState, useRef, useEffect } from 'react';
import { Layout } from './components/Layout';
import { InfoSection } from './components/InfoSection';
import { AIConsultant } from './components/AIConsultant';
import { TissueLayerView } from './components/TissueLayerView';
import { CuratorSection } from './components/CuratorSection';
import { BarrierSection } from './components/BarrierSection';
import { HairCareSection } from './components/HairCareSection';
import { IngredientLibrary } from './components/IngredientLibrary';
import { BioSlider } from './components/BioSlider';
import { SKIN_CARE_ROUTINE, HAIR_CARE_ROUTINE, MORNING_HACKS } from './constants';
import { ArrowRight, Sun, TrendingUp, CheckCircle, Heart, Droplets, Activity, Bookmark, Clock, Target, X, Zap } from 'lucide-react';

const App = () => {
  const [activeTab, setActiveTab] = useState('intro');
  const [mode] = useState('public');
  const [profile, setProfile] = useState(null);
  const [journeyProgress, setJourneyProgress] = useState(30);
  const [savedItems, setSavedItems] = useState([]);
  const scrollContainerRef = useRef(null);

  useEffect(() => {
    const saved = localStorage.getItem('layers_saved_items');
    if (saved) setSavedItems(JSON.parse(saved));
    const savedProfile = localStorage.getItem('layers_user_profile');
    if (savedProfile) setProfile(JSON.parse(savedProfile));
  }, []);

  const tabs = ['intro', 'curate', 'skin', 'hair', 'potions', 'layers', 'consult', 'saved'];

  const handleTabChange = (tabId) => {
    setActiveTab(tabId);
    const index = tabs.indexOf(tabId);
    if (scrollContainerRef.current) {
      const containerWidth = scrollContainerRef.current.clientWidth;
      scrollContainerRef.current.scrollTo({ left: index * containerWidth, behavior: 'smooth' });
    }
  };

  const handleSave = (item) => {
    setSavedItems(prev => {
      const exists = prev.find(i => i.id === item.id);
      const next = exists ? prev.filter(i => i.id !== item.id) : [item, ...prev];
      localStorage.setItem('layers_saved_items', JSON.stringify(next));
      return next;
    });
  };

  const handleProfileUpdate = (newProfile) => {
    setProfile(newProfile);
    localStorage.setItem('layers_user_profile', JSON.stringify(newProfile));
  };

  const handleScroll = () => {
    if (!scrollContainerRef.current) return;
    const scrollLeft = scrollContainerRef.current.scrollLeft;
    const containerWidth = scrollContainerRef.current.clientWidth;
    const index = Math.round(scrollLeft / containerWidth);
    if (tabs[index] && tabs[index] !== activeTab) {
      setActiveTab(tabs[index]);
    }
  };

  return (_jsx("div", { className: "w-full h-full flex items-center justify-center bg-white", children: _jsx(Layout, { activeTab: activeTab, setActiveTab: handleTabChange, mode: mode, onModeToggle: () => { }, children: _jsxs("div", { ref: scrollContainerRef, onScroll: handleScroll, className: "snap-container no-scrollbar scroll-smooth", children: [_jsx("section", { className: "snap-page flex flex-col justify-start no-scrollbar pb-32", children: _jsxs("div", { className: "w-full space-y-10 animate-fade-up py-8", children: [_jsxs("div", { className: "flex flex-col items-center text-center space-y-6", children: [_jsx("div", { className: "logo-rings", children: _jsx("div", { className: "w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-inner", children: _jsx(Heart, { className: "w-12 h-12 text-[#FF6B9D]", fill: "#FF6B9D" }) }) }), _jsxs("div", { className: "space-y-2", children: [_jsx("h1", { className: "text-5xl font-black tracking-tighter text-slate-900 uppercase", children: "LAYERS" }), _jsx("p", { className: "text-sm font-bold text-slate-400 uppercase tracking-[0.2em]", children: "Personal Care Intelligence" })] })] }), profile ? (_jsxs("div", { className: "space-y-8 animate-fade-up", children: [_jsxs("div", { className: "p-8 rounded-[44px] bg-slate-900 text-white space-y-8 shadow-2xl relative overflow-hidden group", children: [_jsx("div", { className: "absolute top-0 right-0 w-48 h-48 bg-[#FF6B9D]/10 rounded-full -mr-20 -mt-20 blur-3xl group-hover:bg-[#FF6B9D]/20 transition-all duration-700" }), _jsxs("div", { className: "flex items-center justify-between relative z-10", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-12 h-12 bg-white/10 rounded-2xl flex items-center justify-center", children: _jsx(Target, { className: "w-6 h-6 text-[#FF6B9D]" }) }), _jsxs("div", { children: [_jsx("span", { className: "text-[10px] font-black uppercase tracking-[0.2em] text-slate-400 block", children: "Biological Focus" }), _jsx("h3", { className: "text-xl font-black uppercase tracking-tight", children: profile.mainSkinConcern })] })] }), _jsxs("div", { className: "text-right", children: [_jsx("span", { className: "text-[10px] font-black uppercase tracking-widest text-slate-400 block", children: "Health Index" }), _jsx("span", { className: "text-2xl font-black text-[#17B8A0]", children: "8.4" })] })] }), _jsxs("div", { className: "space-y-4 relative z-10", children: [_jsx("div", { className: "flex items-end justify-between gap-1 h-20", children: [35, 42, 38, 55, 62, 58, 75].map((val, i) => (_jsx("div", { className: "flex-1 bg-white/5 rounded-t-lg relative group/bar", children: _jsx("div", { className: "absolute bottom-0 left-0 right-0 bg-gradient-to-t from-[#17B8A0] to-[#17B8A0]/50 rounded-t-lg transition-all duration-1000 delay-150", style: { height: `${val}%` } }) }, i))) }), _jsxs("div", { className: "flex justify-between text-[8px] font-black text-slate-500 uppercase tracking-widest", children: [_jsx("span", { children: "Mon" }), _jsx("span", { children: "Today" })] })] }), _jsxs("div", { className: "grid grid-cols-2 gap-4 relative z-10 pt-4 border-t border-white/5", children: [_jsxs("div", { className: "space-y-1", children: [_jsx("span", { className: "text-[9px] font-black uppercase tracking-widest text-slate-500", children: "Hydration" }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Zap, { className: "w-3 h-3 text-[#FFB84D]" }), _jsx("span", { className: "text-sm font-black", children: "+14% Growth" })] })] }), _jsxs("div", { className: "space-y-1 border-l border-white/5 pl-4", children: [_jsx("span", { className: "text-[9px] font-black uppercase tracking-widest text-slate-500", children: "Barrier" }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx(TrendingUp, { className: "w-3 h-3 text-[#17B8A0]" }), _jsx("span", { className: "text-sm font-black text-[#17B8A0]", children: "Optimal" })] })] })] })] }), _jsxs("div", { className: "grid grid-cols-2 gap-5 px-1", children: [_jsxs("button", { onClick: () => handleTabChange('skin'), className: "p-8 rounded-[40px] bg-white border-2 border-slate-50 hover:border-[#FF6B9D]/20 transition-all flex flex-col items-center gap-4 group active:scale-95 shadow-sm", children: [_jsx("div", { className: "w-14 h-14 bg-[#FF6B9D]/10 rounded-2xl flex items-center justify-center group-hover:rotate-12 transition-transform", children: _jsx(Droplets, { className: "w-7 h-7 text-[#FF6B9D]" }) }), _jsx("span", { className: "text-xs font-black uppercase tracking-widest text-slate-900", children: "Skin Lab" })] }), _jsxs("button", { onClick: () => handleTabChange('hair'), className: "p-8 rounded-[40px] bg-white border-2 border-slate-50 hover:border-[#FFB84D]/20 transition-all flex flex-col items-center gap-4 group active:scale-95 shadow-sm", children: [_jsx("div", { className: "w-14 h-14 bg-[#FFB84D]/10 rounded-2xl flex items-center justify-center group-hover:rotate-12 transition-transform", children: _jsx(Activity, { className: "w-7 h-7 text-[#FFB84D]" }) }), _jsx("span", { className: "text-xs font-black uppercase tracking-widest text-slate-900", children: "Hair Lab" })] })] })] })) : (_jsxs("div", { className: "grid grid-cols-2 gap-5 px-1", children: [_jsxs("button", { onClick: () => handleTabChange('skin'), className: "p-8 rounded-[40px] bg-[#FF6B9D] text-white hover:opacity-90 transition-all flex flex-col items-center gap-4 border-none group active:scale-95 shadow-xl shadow-[#FF6B9D]/20", children: [_jsx("div", { className: "w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center group-hover:rotate-12 transition-transform", children: _jsx(Droplets, { className: "w-7 h-7 text-white" }) }), _jsx("span", { className: "text-xs font-black uppercase tracking-widest", children: "Skin Lab" })] }), _jsxs("button", { onClick: () => handleTabChange('hair'), className: "p-8 rounded-[40px] bg-[#FFB84D] text-white hover:opacity-90 transition-all flex flex-col items-center gap-4 border-none group active:scale-95 shadow-xl shadow-[#FFB84D]/20", children: [_jsx("div", { className: "w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center group-hover:rotate-12 transition-transform", children: _jsx(Activity, { className: "w-7 h-7 text-white" }) }), _jsx("span", { className: "text-xs font-black uppercase tracking-widest", children: "Hair Lab" })] })] })), _jsxs("div", { className: "space-y-6 pt-4", children: [_jsxs("div", { className: "flex items-center gap-3 px-2", children: [_jsx(TrendingUp, { className: "w-6 h-6 text-[#17B8A0]" }), _jsx("h3", { className: "text-xl font-black text-slate-900 uppercase tracking-tight", children: "Barrier Recovery" })] }), _jsx("div", { className: "px-1", children: _jsx(BioSlider, { progress: journeyProgress, onChange: setJourneyProgress }) })] }), _jsxs("div", { className: "pt-8 px-2 space-y-4", children: [_jsxs("button", { onClick: () => handleTabChange('curate'), className: "w-full h-20 rounded-[32px] bg-slate-900 text-white text-base font-black uppercase tracking-[0.2em] flex items-center justify-center gap-4 shadow-2xl active:scale-95 transition-all", children: [profile ? 'Refine Assessment' : 'Start Assessment', " ", _jsx(ArrowRight, { className: "w-6 h-6" })] }), savedItems.length > 0 && (_jsxs("button", { onClick: () => handleTabChange('saved'), className: "w-full h-16 rounded-[32px] border-2 border-slate-100 text-slate-900 text-xs font-black uppercase tracking-[0.2em] flex items-center justify-center gap-4 active:scale-95 transition-all", children: ["View Saved Vault ", _jsx(Bookmark, { className: "w-5 h-5 text-[#C084FC]" })] }))] })] }) }), _jsx("section", { className: "snap-page flex items-center justify-center", children: _jsx(CuratorSection, { onProfileUpdate: handleProfileUpdate, onComplete: () => handleTabChange('consult'), mode: mode }) }), _jsx("section", { className: "snap-page pb-32", children: _jsxs("div", { className: "space-y-12 py-8", children: [_jsx(BarrierSection, {}), _jsx(InfoSection, { title: "Skin Ritual", subtitle: "Daily Protocol", steps: SKIN_CARE_ROUTINE, theme: "rose" }), _jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "flex items-center gap-3 px-1", children: [_jsx(Sun, { className: "w-6 h-6 text-[#FFB84D]" }), _jsx("h2", { className: "text-xl font-black text-slate-900 uppercase tracking-tight", children: "Morning Hacks" })] }), _jsx("div", { className: "side-scroller no-scrollbar px-1", children: MORNING_HACKS.map((h, i) => (_jsxs("div", { className: "w-64 p-7 rounded-[32px] bg-slate-50 border-none space-y-4 shadow-sm min-h-[160px] flex flex-col justify-between", children: [_jsx("h3", { className: "text-lg font-black text-slate-800 uppercase leading-tight whitespace-normal break-words", children: h.title }), _jsx("p", { className: "text-[14px] text-slate-500 font-medium leading-relaxed", children: h.desc }), _jsxs("div", { className: "flex items-center gap-2 text-[10px] font-black text-[#17B8A0] uppercase tracking-widest pt-2 mt-auto border-t border-slate-200/50 w-full whitespace-normal break-words", children: [_jsx(CheckCircle, { className: "w-4 h-4 shrink-0" }), " ", h.benefit] })] }, i))) })] })] }) }), _jsx("section", { className: "snap-page pb-32", children: _jsxs("div", { className: "space-y-12 py-8", children: [_jsx(HairCareSection, {}), _jsx(InfoSection, { title: "Hair Ritual", subtitle: "Care Plan", steps: HAIR_CARE_ROUTINE, theme: "amber" })] }) }), _jsx("section", { className: "snap-page pb-32", children: _jsxs("div", { className: "space-y-8 py-8", children: [_jsxs("header", { className: "text-center space-y-2", children: [_jsx("h1", { className: "text-4xl font-black text-slate-900 uppercase tracking-tighter", children: "The Lab" }), _jsx("p", { className: "text-xs font-bold text-slate-400 uppercase tracking-[0.3em]", children: "100% Real Bio-Ingredients" })] }), _jsx(IngredientLibrary, { onSave: handleSave, savedItems: savedItems })] }) }), _jsx("section", { className: "snap-page pb-32", children: _jsx(TissueLayerView, {}) }), _jsx("section", { className: "snap-page pb-32", children: _jsx(AIConsultant, { onSave: handleSave, savedItems: savedItems, profile: profile || {
                            mode, skincareTime: 'Every Day', skinType: 'Normal', hairType: 'Straight',
                            mainSkinConcern: 'Balanced', mainHairConcern: 'None', ingredientAllergies: []
                          } }) }), _jsx("section", { className: "snap-page pb-32", children: _jsxs("div", { className: "w-full space-y-8 py-8 animate-fade-up", children: [_jsxs("header", { className: "text-center space-y-2", children: [_jsx("div", { className: "w-16 h-16 bg-[#C084FC]/10 rounded-3xl flex items-center justify-center mx-auto text-[#C084FC] mb-4 shadow-inner", children: _jsx(Bookmark, { className: "w-8 h-8" }) }), _jsx("h1", { className: "text-3xl font-black text-slate-900 uppercase tracking-tighter", children: "Saved Vault" }), _jsx("p", { className: "text-xs font-bold text-slate-400 uppercase tracking-[0.3em]", children: "Your Bookmarked Insights" })] }), _jsx("div", { className: "space-y-4", children: savedItems.length > 0 ? savedItems.map(item => (_jsxs("div", { className: "p-6 rounded-[32px] bg-slate-50 border-none flex items-center justify-between group hover:bg-[#C084FC]/5 transition-all", children: [_jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "w-12 h-12 bg-white rounded-2xl flex items-center justify-center text-[#C084FC] shadow-sm", children: item.type === 'ingredient' ? _jsx(Droplets, { className: "w-5 h-5" }) : _jsx(Activity, { className: "w-5 h-5" }) }), _jsxs("div", { children: [_jsx("span", { className: "text-[8px] font-black uppercase text-slate-400 tracking-widest block mb-0.5", children: item.type }), _jsx("h4", { className: "text-sm font-black text-slate-900 uppercase line-clamp-1", children: item.title })] })] }), _jsx("button", { onClick: () => handleSave(item), className: "text-slate-200 hover:text-[#FF6B9D] transition-colors p-2", children: _jsx(X, { className: "w-5 h-5" }) })] }, item.id))) : (_jsxs("div", { className: "py-20 text-center space-y-4 opacity-30", children: [_jsx(Clock, { className: "w-12 h-12 mx-auto" }), _jsx("p", { className: "text-xs font-black uppercase tracking-widest", children: "Your vault is empty" })] })) })] }) })] }) }) }));
};

export default App;
